{% extends "base.html" %}

{% block title %}Dashboard - Discord Notifier{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Notifications</h1>
    <p class="subtitle">Manage your scheduled Discord notifications</p>
</div>

{% if notifications %}
    <div class="notifications-list">
        {% for notif in notifications %}
            <div class="card notification-card">
                <div class="card-header">
                    <div class="card-title">
                        <a href="{{ url_for('main.edit_notification', name=notif.name) }}">{{ notif.name }}</a>
                        {% if notif.enabled %}
                            <span class="badge badge-success">Enabled</span>
                        {% else %}
                            <span class="badge badge-muted">Disabled</span>
                        {% endif %}
                    </div>
                    <div class="btn-group">
                        <form method="post" action="{{ url_for('main.test_notification', name=notif.name) }}" style="display: inline;">
                            <button type="submit" class="btn btn-ghost btn-sm" title="Send test notification">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"/>
                                </svg>
                                Test
                            </button>
                        </form>
                        <a href="{{ url_for('main.edit_notification', name=notif.name) }}" class="btn btn-secondary btn-sm">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"/>
                            </svg>
                            Edit
                        </a>
                    </div>
                </div>
                <div class="notification-details">
                    {% if notif.enabled %}
                        <div class="schedule-info">
                            <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor" class="text-muted">
                                <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7-3.25v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5a.75.75 0 0 1 1.5 0Z"/>
                            </svg>
                            <span class="text-secondary">{{ notif.schedule_human or notif.schedule }}</span>
                            {% if notif.next_run %}
                                <span class="text-muted">Â· Next: {{ notif.next_run.strftime('%b %d, %H:%M') }}</span>
                            {% endif %}
                        </div>
                    {% endif %}
                    <p class="message-preview text-muted">{{ notif.message_preview }}</p>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="card empty-state">
        <svg width="48" height="48" viewBox="0 0 16 16" fill="currentColor" class="text-muted" style="margin-bottom: 1rem;">
            <path d="M1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5C0 2.784.784 2 1.75 2ZM1.5 12.251c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V5.809L8.38 9.397a.75.75 0 0 1-.76 0L1.5 5.809v6.442Zm13-8.181v-.32a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25v.32L8 7.88Z"/>
        </svg>
        <h2>No notifications yet</h2>
        <p class="text-secondary mb-2">Create your first notification to get started.</p>
        <a href="{{ url_for('main.new_notification') }}" class="btn btn-primary">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"/>
            </svg>
            Create Notification
        </a>
    </div>
{% endif %}

<style>
    .notifications-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .notification-card {
        transition: transform 0.2s, border-color 0.2s;
    }

    .notification-card:hover {
        transform: translateY(-2px);
    }

    .notification-details {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .schedule-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
    }

    .message-preview {
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-family: 'JetBrains Mono', monospace;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 2rem;
    }
</style>
{% endblock %}

